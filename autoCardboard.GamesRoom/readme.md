# Testing GamesRoom ClientApp

May 2021

---

This turned into a more general dive into the files in GamesRoom\ClientApp and what they are for....

* Change directory to c:\code\autoCardboard\autoCardboard.GamesRoom\ClientApp
* Run the command "ng test" ( see https://angular.io/cli/test )

	In Angular. js the prefix ng stands for "Angular;" all of the built-in directives that ship with Angular use that prefix. Similarly, it is recommended that you do not use the ng prefix on your own directives in order to avoid possible name collisions in future versions of Angular.

* It starts browser, loads Karma, loads Jasmine, looks for tests to run

---

## SSR
Server Side Rendering


## readme.md

C:\code\autoCardboard\autoCardboard.GamesRoom\ClientApp\readme.md
This was generated by the Visual Studio 2019 template : Angular SPA template for ASP.NET Core 3.0
: https://docs.microsoft.com/en-us/aspnet/core/client-side/spa/angular?view=aspnetcore-5.0&tabs=visual-studio

	The updated Angular project template provides a convenient starting point for ASP.NET Core apps using Angular and the Angular CLI to implement a rich, client-side user interface (UI).

	The template is equivalent to creating an ASP.NET Core project to act as an API backend and an Angular CLI project to act as a UI. The template offers the convenience of hosting both project types in a single app project. Consequently, the app project can be built and published as a single unit.

The CLientApp subdirectory is a standard Angular CLI application.

If you open a command prompt in that directory, you can run any ng command, or use npm to install extra packages into it.


# UseProxyToSpaDevelopmentServer
https://docs.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.builder.spaproxyingextensions.useproxytospadevelopmentserver?view=aspnetcore-5.0

We have : 
```c#
app.UseSpa(spa =>
{
    // To learn more about options for serving an Angular SPA from ASP.NET Core,
    // see https://go.microsoft.com/fwlink/?linkid=864501

    spa.Options.SourcePath = "ClientApp";

    if (env.IsDevelopment())
    {
        /*
           I have removed : spa.UseAngularCliServer(npmScript: "start");
           Which caused the Angular CLI server to run in the background
           so startup/restart after code changes will be faster
           
           However you are now responsible for running "npm start" in the clientApp folder, in a terminal

           See https://docs.microsoft.com/en-us/aspnet/core/client-side/spa/angular?view=aspnetcore-5.0&tabs=visual-studio
         */
        spa.UseProxyToSpaDevelopmentServer("http://localhost:4200");
    }
});
```

UseSpa : Handles all requests from this point in the middleware chain by returning the default page for the Single Page Application (SPA).

---

# Angular.CLI

https://angular.io/cli

The Angular CLI is a command-line interface tool that you use to initialize, develop, scaffold, and maintain Angular applications directly from a command shell.

can install with : npm install -g @angular/cli

Invoke the tool on the command line through the ng executable.

---

# Node
	Node.js, a JavaScript runtime for building server-side or desktop applications.

	Node can, therefore, be used to write server-side applications with access to the operating system, file system, and everything else required to build fully-functional applications.

	Node.js is written in C, C++, and JavaScript, and it is built on the open-source V8 JavaScript engine which also powers JS in browsers such as Google Chrome. As V8 supports new features in JavaScript, they are incorporated into Node.

---
Can replace "ng test" => "npm test"

	https://nodejs.org/en/knowledge/getting-started/npm/what-is-npm/

	npm is two things: first and foremost, it is an online repository for the publishing of open-source Node.js projects; second, it is a command-line utility for interacting with said repository that aids in package installation, version management, and dependency management.

	A plethora of Node.js libraries and applications are published on npm, and many more are added every day. These applications can be searched for on https://www.npmjs.com/. Once you have a package you want to install, it can be installed with a single command-line command.

---

# Angular workspace configuration

https://angular.io/guide/workspace-config

We have file : C:\code\autoCardboard\autoCardboard.GamesRoom\ClientApp\angular.json

A file named angular.json at the root level of an Angular workspace provides workspace-wide and project-specific configuration defaults for build and development tools provided by the Angular CLI. Path values given in the configuration are relative to the root workspace folder.

# Angular CLI builders

https://angular.io/guide/cli-builder

A number of Angular CLI commands run a complex process on your code, such as linting, building, or testing. The commands use an internal tool called Architect to run CLI builders, which apply another tool to accomplish the desired task.

With Angular version 8, the CLI Builder API is stable and available to developers who want to customize the Angular CLI by adding or modifying commands. For example, you could supply a builder to perform an entirely new task, or to change which third-party tool is used by an existing command.


By default, for example, the build command runs the builder @angular-devkit/build-angular:browser to perform the build task, and passes in default option values as specified for the build target in angular.json.

# ng e2e

end to end

https://angular.io/cli/e2e

Builds and serves an Angular app, then runs end-to-end tests using Protractor.

# Protractor

https://www.npmjs.com/package/protractor

### This has example of writing a test : http://www.protractortest.org/#/
The test opens a webPage, finds elements, clicks on them, expects to see elements with specific text

Protractor is an end-to-end test framework for Angular and AngularJS applications. Protractor is a Node.js program built on top of WebDriverJS. Protractor runs tests against your application running in a real browser, interacting with it as a user would.

Our config file is here : C:\code\autoCardboard\autoCardboard.GamesRoom\ClientApp\e2e\protractor.conf.js

## WebDriverJS

WebDriverJs is the Official javascript implementation of selenium. It uses the Selenium's Json-wire-protocol to interact with browser as selenium java does. It is written by selenium guys. Webdriverjs is packaged as 'selenium-webdriver' under npm package which runs on nodejs.

WebDriver is a web automation framework that allows you to execute your tests against different browsers, not just Firefox, Chrome (unlike Selenium IDE). WebDriver also enables you to use a programming language in creating your test scripts (not possible in Selenium IDE).

Additionally, what is Jasmine in protractor? Jasmine is a Behavior Driven Development testing framework for JavaScript. js projects, or anywhere that JavaScript can run; Protractor: End-to-end test framework for Angular and AngularJS applications. Protractor is an end-to-end test framework for Angular and AngularJS applications.

## Selenium

Selenium is an open-source tool for automating your testing of web applications. It has been around for many years and has become the most popular tool for automating web browsers. You can do what you want with it regarding browser functionality, use it to automate tests on web applications or even use it for web-based administration tasks. Selenium has the support of all of the largest web browser vendors, and is really well supported by the developer community.


Selenium IDE is a browser plug-in, and allows you to quickly create automated tests through record & reply and then add your own validation points.

## tslint.json

https://palantir.github.io/tslint/

we have file : C:\code\autoCardboard\autoCardboard.GamesRoom\ClientApp\tslint.json

## tsconfig.json

The presence of a tsconfig.json file in a directory indicates that the directory is the root of a TypeScript project. The tsconfig.json file specifies the root files and the compiler options required to compile the project.

---

## Package.json

```json
"name": "autocardboard.gamesroom",
  "version": "0.0.0",
  "scripts": {
    "ng": "ng",
    "start": "ng serve",
    "build": "ng build",
    "build:ssr": "ng run autoCardboard.GamesRoom:server:dev",
    "test": "ng test",
    "lint": "ng lint",
    "e2e": "ng e2e"
  },
  "private": true,
```



---

https://app.pluralsight.com/guides/introduction-to-angular-test-driven-development

## Karma
Karma is an environment which runs the tests of your application. Simply put, it's your testing server. 

Karma aims to make a framework-agnostic environment that automates the running of your unit tests. In its core, it is a Node server that watches for changes in your testing and application files, and when such changes occur, it runs them in a browser and checks for mistakes.

We have the karma configuration file : C:\code\autoCardboard\autoCardboard.GamesRoom\ClientApp\src\karma.conf.js

## Instanbul Reporter - configured in Karma
https://istanbul.js.org/

Istanbul instruments your ES5 and ES2015+ JavaScript code with line counters, so that you can track how well your unit-tests exercise your codebase.

## karma-jasmine-html-reporter - configured in Karma
https://www.npmjs.com/package/karma-jasmine-html-reporter

Reporter that dynamically shows tests results at debug.html page.

## Jasmine
Jasmine is an unit testing framework for JavaScript. It is the most popular framework for testing JavaScript applications.



## Angular Mocks
Angular Mocks is an Angular module that is used to mock components that already exist in the application. 

Its role is to inject various components of your Angular application (controllers, services, factories, directives, filters) and make them available for unit tests. It can be said that Angular Mocks is the middleman between the Angular components in your application and the unit testing environment.